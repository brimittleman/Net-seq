---
title: "Use the genomation package to vizualize genome features and see overlap with Net-seq1"
author: "Briana Mittleman"
date: 2017-11-09
output: html_document
---

<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
```{r read-chunk, include=FALSE, cache=FALSE}
knitr::read_chunk("chunks.R")
```

<!-- Update knitr chunk options -->
```{r knitr-opts-chunk, include=FALSE}
```

<!-- Insert the date the file was last updated -->
```{r last-updated, echo=FALSE, results='asis'}
```

<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
```{r code-version, echo=FALSE, results='asis'}
```

I will look at genome feature overlap with the Netseq1 libary. I will start with one sample then move to more once the code is working. I will look specifically at overlap with CTCF sites. 


Load libraries:  
```{r}
library(genomation)
library(genomationData)
```


###Load gata: 

```{r}
CTCF_gen= readGeneric(file = "../data/hg19.GM72.CTCF", header=FALSE, keep.all.metadata = TRUE)
#bed file for one of my libraries  
# to get from midway
#scp brimittleman@midway2.rcc.uchicago.edu:/project2/gilad/briana/Net-seq/Net-seq1/data/cov/YG-SP-NET1-18486-dep-2017-10-13_S4_R1_001-sort.dedup.cov.bed .

dedup.18486.dep= readGeneric(file= "../data/net1_18486_dep_dedup_chr.bed", header = FALSE, keep.all.metadata = TRUE)



```


###Data extaction:  

Try to get the density of net-seq reads around CTCF sites  

fix formating of file with 

```{bash, eval=FALSE }
#awk '$0="chr"$0' file  > newfile
```

Need to do this with the reads not the coverage file. I used the samtools bamtobed function on one of the dedup files and copied this to the data file here.  


```{r}
peak.annot = annotateWithFeature(CTCF_gen, dedup.18486.dep, intersect.chr = TRUE)
peak.annot


```
I need to compare this to another feature. I will look at the genes file.  

```{r}
genes= readGeneric(file= "../data/hg19.ref.genes.bed", header = FALSE, keep.all.metadata = TRUE)
head(genes)

peak.annot_genes = annotateWithFeature(genes, dedup.18486.dep, intersect.chr = TRUE)
peak.annot_genes
```
The genes file has a lot of random chr tags at the end.  

## Session information

<!-- Insert the session information into the document -->
```{r session-info}
```
